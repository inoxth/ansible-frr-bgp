---
- name: as-set {{ as_set_config.as_set }}/ gather ipv4 prefixes
  command: bgpq4 -4 -A -m 24 -F "%n/%l ge %a le %A\n" -h {{ frr_irrd_server }} {{ as_set_config.as_set }}
  register: irrv4
  changed_when: false

- name: as-set {{ as_set_config.as_set }}/ gather ipv6 prefixes
  command: bgpq4 -6 -A -m 48 -F "%n/%l ge %a le %A\n" -h {{ frr_irrd_server }} {{ as_set_config.as_set }}
  register: irrv6
  changed_when: false

- name: run frr-prefixlist role
  import_role:
    name: frr-prefixlist
  vars: 
    frr_prefixlists:
    - name: "{{ as_set_config.name }}"
      address_family: ipv4
      entries: "{{ irrv4.stdout_lines }}"
    - name: "{{ as_set_config.name }}"
      address_family: ipv6
      entries: "{{ irrv6.stdout_lines }}"